= Demo Web Lead Process

Invoke by posting the following content

[source,JSON]
----
{
    "pWebLead": {
        "com.home_security.web_lead.WebLead": {
            "formName": "default",
            "promotionCode": "WEB0001421",
            "messageDivision": "resi",
            "messageType": "L",
            "emailSubject": "Home Security Review DNIS:WEB0001421",
            "firstName": "Ben",
            "lastName": "Xxxxxx",
            "stateCode": "AZ",
            "countryCode": "US",
            "zipCode": "85716",
            "primaryPhoneNumber": "9905556922",
            "emailAddress": "benXxxxx@yahoo.com",
            "sourceIP": "99.43.34.116",
            "createDateTime": "2020-07-03T08:11:40"
        }
    }
}
----

to the end point

[source,URL]
----
[KIE-SERVER ROUTE]/services/rest/server/containers/Web-Lead-Process/processes/Web-Lead-Process.DecisionFlow/instances
----

The JPA Work Item Handlers require a XA driver. Configure the kie-server template to insert the following in JBoss standalone-openshift.xml for PostgreSQL:

[source,XML]
----
        <subsystem xmlns="urn:jboss:domain:datasources:5.0">
            <datasources>
            ...
        <datasource jta="true" jndi-name="java:/jboss/datasources/[USER NAME]" pool-name="[DATASOURCE NAME]" enabled="true" use-java-context="true" statistics-enabled="${wildfly.datasources.statistics-enabled:${wildfly.statistics-enabled:false}}">
          <connection-url>jdbc:postgresql://[DB SERVICE NAME]:5432/[DATABASE NAME]</connection-url>
          <driver>postgresql</driver>
          <security>
            <user-name>[USER]</user-name>
            <password>[PASSWORD]</password>
          </security>
        </datasource>
                ...
                <drivers>
                ...
                    <driver name="postgresqlXA" module="org.postgresql">
                        <xa-datasource-class>org.postgresql.xa.PGXADataSource</xa-datasource-class>
                    </driver>
                    ...
                </drivers>
            </datasources>
        </subsystem>
----